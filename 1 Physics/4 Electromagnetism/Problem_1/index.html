<!DOCTYPE html>

<html class="writer-html5" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="../../../img/favicon.ico" rel="shortcut icon"/>
<title>Problem 1 - Physics and Mathematics</title>
<link href="../../../css/theme.css" rel="stylesheet"/>
<link href="../../../css/theme_extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" rel="stylesheet"/>
<script>
        // Current page data
        var mkdocs_page_name = "Problem 1";
        var mkdocs_page_input_path = "1 Physics/4 Electromagnetism/Problem_1.md";
        var mkdocs_page_url = null;
      </script>
<!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
<script>hljs.highlightAll();</script>
</head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../../.."> Physics and Mathematics
        </a><div role="search">
<form action="../../../search.html" class="wy-form" id="rtd-search-form" method="get">
<input aria-label="Search docs" name="q" placeholder="Search docs" title="Type search term here" type="text"/>
</form>
</div>
</div>
<div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../..">Introduction</a>
</li>
</ul>
<p class="caption"><span class="caption-text">1 Physics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal">1 Mechanics</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../1%20Mechanics/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../1%20Mechanics/Problem_2/">Problem 2</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">2 Gravity</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_2/">Problem 2</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_3/">Problem 3</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">3 Waves</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../3%20Waves/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal current">4 Electromagnetism</a>
<ul class="current">
<li class="toctree-l2 current"><a class="reference internal current" href="#">Problem 1</a>
<ul class="current">
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">5 Circuits</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../5%20Circuits/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">6 Statistics</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../6%20Statistics/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../6%20Statistics/Problem_2/">Problem 2</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">7 Measurements</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../7%20Measurements/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">2 Mathematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/1%20Linear_algebra/">Linear Algebra</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/2%20Analytic_geometry/">Analytic geometry</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/3%20Calculus/">Calculus</a>
</li>
</ul>
<p class="caption"><span class="caption-text">3 Discret Mathematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal">1 Set Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_02%20Set_Theory/">Set Theory</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_03%20Relations/">Relations</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_04%20Functions/">Functions</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">2 Number Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/2%20Number%20Theory%20and%20.../_05%20Combinatorics/">Combinatorics</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/2%20Number%20Theory%20and%20.../_08%20Number_Theory/">Number Theory</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">3 Recurrence and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_06%20Sequences_and_Series/">Sequences and Series</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_07%20Induction/">Induction</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_09%20Recurrence/">Recurrence</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">4 Graph Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/4%20Graph%20Theory%20and%20.../_10%20Graph_Theory/">Graph Theory</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">5 Logic</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/5%20Logic/_01%20Logic/">Logic</a>
</li>
</ul>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="Mobile navigation menu" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../../..">Physics and Mathematics</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content"><div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a aria-label="Docs" class="icon icon-home" href="../../.."></a></li>
<li class="breadcrumb-item">1 Physics</li>
<li class="breadcrumb-item">4 Electromagnetism</li>
<li class="breadcrumb-item active">Problem 1</li>
<li class="wy-breadcrumbs-aside">
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div class="section" itemprop="articleBody">
<p>import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
from matplotlib.animation import FuncAnimation
import matplotlib.gridspec as gridspec</p>
<p>def simulate_uniform_B(q, m, B, v0, r0, dt, steps):
    """Enhanced simulation with energy and momentum tracking"""
    r = np.zeros((steps, 3))
    v = np.zeros((steps, 3))
    E_kinetic = np.zeros(steps)
    angular_momentum = np.zeros((steps, 3))
    magnetic_moment = np.zeros(steps)</p>
<pre><code>r[0] = r0
v[0] = v0

# Initial values
E_kinetic[0] = 0.5 * m * np.sum(v[0]**2)
angular_momentum[0] = m * np.cross(r[0], v[0])

B_mag = np.linalg.norm(B)
v_perp = v[0] - np.dot(v[0], B) * B / B_mag**2
magnetic_moment[0] = 0.5 * m * np.sum(v_perp**2) / B_mag

for i in range(1, steps):
    F = q * np.cross(v[i-1], B)
    a = F / m
    v[i] = v[i-1] + a * dt
    r[i] = r[i-1] + v[i] * dt

    # Calculate conserved quantities
    E_kinetic[i] = 0.5 * m * np.sum(v[i]**2)
    angular_momentum[i] = m * np.cross(r[i], v[i])
    v_perp = v[i] - np.dot(v[i], B) * B / B_mag**2
    magnetic_moment[i] = 0.5 * m * np.sum(v_perp**2) / B_mag

return r, v, E_kinetic, angular_momentum, magnetic_moment
</code></pre>
<p>def simulate_EB_fields(q, m, E, B, v0, r0, dt, steps):
    """Enhanced E×B drift simulation with additional physics parameters"""
    r = np.zeros((steps, 3))
    v = np.zeros((steps, 3))
    drift_velocity = np.zeros((steps, 3))
    gyroradius = np.zeros(steps)
    total_energy = np.zeros(steps)</p>
<pre><code>r[0] = r0
v[0] = v0

B_mag = np.linalg.norm(B)
drift_velocity_theoretical = np.cross(E, B) / (B_mag**2)

for i in range(1, steps):
    F = q * (E + np.cross(v[i-1], B))
    a = F / m
    v[i] = v[i-1] + a * dt
    r[i] = r[i-1] + v[i] * dt

    # Calculate drift velocity and gyroradius
    v_perp = v[i] - np.dot(v[i], B) * B / (B_mag**2)
    drift_velocity[i] = np.cross(E, B) / (B_mag**2)
    gyroradius[i] = m * np.linalg.norm(v_perp) / (abs(q) * B_mag)

    # Calculate total energy (kinetic + potential)
    total_energy[i] = 0.5 * m * np.sum(v[i]**2) + q * np.dot(E, r[i])

return r, v, drift_velocity, gyroradius, total_energy
</code></pre>
<h1 id="parameters">Parameters</h1>
<p>q = 1.6e-19  # electron charge
m = 9.1e-31  # electron mass
B = np.array([0, 0, 0.1])  # magnetic field in T
E = np.array([1000, 0, 0])  # electric field in V/m
v0 = np.array([1e6, 1e6, 0])  # initial velocity
r0 = np.array([0, 0, 0])  # initial position
dt = 1e-11
steps = 1000</p>
<h1 id="run-simulations">Run simulations</h1>
<p>r_B, v_B, E_kin, L, mu = simulate_uniform_B(q, m, B, v0, r0, dt, steps)
r_EB, v_EB, v_drift, rg, E_total = simulate_EB_fields(q, m, E, B, v0, r0, dt, steps)</p>
<h1 id="create-comprehensive-visualization-with-8-subplots">Create comprehensive visualization with 8 subplots</h1>
<p>plt.style.use('seaborn-darkgrid')
fig = plt.figure(figsize=(20, 15))
gs = gridspec.GridSpec(4, 2)</p>
<h1 id="1-3d-trajectory-in-b-field">1. 3D trajectory in B field</h1>
<p>ax1 = fig.add_subplot(gs[0, 0], projection='3d')
ax1.plot(r_B[:, 0], r_B[:, 1], r_B[:, 2], 'b-', label='Trajectory')
ax1.set_title('3D Particle Trajectory (B field)')
ax1.set_xlabel('X (m)')
ax1.set_ylabel('Y (m)')
ax1.set_zlabel('Z (m)')
ax1.legend()</p>
<h1 id="2-energy-conservation-in-b-field">2. Energy conservation in B field</h1>
<p>ax2 = fig.add_subplot(gs[0, 1])
t = np.arange(steps) * dt
ax2.plot(t, E_kin / E_kin[0], 'g-', label='Normalized Kinetic Energy')
ax2.set_title('Energy Conservation (B field)')
ax2.set_xlabel('Time (s)')
ax2.set_ylabel('E/E₀')
ax2.legend()</p>
<h1 id="3-eb-drift-trajectory">3. E×B drift trajectory</h1>
<p>ax3 = fig.add_subplot(gs[1, 0], projection='3d')
ax3.plot(r_EB[:, 0], r_EB[:, 1], r_EB[:, 2], 'r-', label='E×B Drift')
ax3.set_title('3D Particle Trajectory (E×B fields)')
ax3.set_xlabel('X (m)')
ax3.set_ylabel('Y (m)')
ax3.set_zlabel('Z (m)')
ax3.legend()</p>
<h1 id="4-total-energy-in-eb-fields">4. Total energy in E×B fields</h1>
<p>ax4 = fig.add_subplot(gs[1, 1])
ax4.plot(t, E_total / E_total[0], 'm-', label='Normalized Total Energy')
ax4.set_title('Total Energy Conservation (E×B fields)')
ax4.set_xlabel('Time (s)')
ax4.set_ylabel('E_total/E₀')
ax4.legend()</p>
<h1 id="5-magnetic-moment-conservation">5. Magnetic moment conservation</h1>
<p>ax5 = fig.add_subplot(gs[2, 0])
ax5.plot(t, mu / mu[0], 'c-', label='Normalized Magnetic Moment')
ax5.set_title('Magnetic Moment Conservation')
ax5.set_xlabel('Time (s)')
ax5.set_ylabel('μ/μ₀')
ax5.legend()</p>
<h1 id="6-angular-momentum-components">6. Angular momentum components</h1>
<p>ax6 = fig.add_subplot(gs[2, 1])
ax6.plot(t, L[:, 0], 'b-', label='Lx')
ax6.plot(t, L[:, 1], 'r-', label='Ly')
ax6.plot(t, L[:, 2], 'g-', label='Lz')
ax6.set_title('Angular Momentum Components')
ax6.set_xlabel('Time (s)')
ax6.set_ylabel('Angular Momentum (kg⋅m²/s)')
ax6.legend()</p>
<h1 id="7-phase-space-plot-x-vx">7. Phase space plot (x-vx)</h1>
<p>ax7 = fig.add_subplot(gs[3, 0])
ax7.plot(r_B[:, 0], v_B[:, 0], 'k.', markersize=1, label='Phase Space')
ax7.set_title('Phase Space (x-vx)')
ax7.set_xlabel('Position x (m)')
ax7.set_ylabel('Velocity vx (m/s)')
ax7.legend()</p>
<h1 id="8-gyroradius-evolution">8. Gyroradius evolution</h1>
<p>ax8 = fig.add_subplot(gs[3, 1])
ax8.plot(t, rg * 1e6, 'y-', label='Gyroradius')
ax8.set_title('Gyroradius Evolution')
ax8.set_xlabel('Time (s)')
ax8.set_ylabel('Radius (μm)')
ax8.legend()</p>
<p>plt.tight_layout()
plt.show()</p>
<h1 id="additional-theoretical-analysis-and-formulas">Additional theoretical analysis and formulas:</h1>
<p>"""
Key Physics Formulas and Concepts:</p>
<ol>
<li>
<p>Cyclotron Frequency:
   ω_c = qB/m</p>
</li>
<li>
<p>Larmor Radius:
   r_L = mv_⊥/(qB)</p>
</li>
<li>
<p>E×B Drift Velocity:
   v_d = (E×B)/B²</p>
</li>
<li>
<p>Magnetic Moment (First Adiabatic Invariant):
   μ = mv_⊥²/(2B)</p>
</li>
<li>
<p>Drift Velocities:</p>
</li>
<li>Gradient B drift: v_∇B = (mv_⊥²/2qB³)(B×∇B)</li>
<li>Curvature drift: v_c = (mv_∥²/qB³)R_c×B</li>
<li>
<p>Polarization drift: v_p = (m/qB²)dE_⊥/dt</p>
</li>
<li>
<p>Energy Conservation:
   d/dt(½mv²) = qE·v</p>
</li>
<li>
<p>Canonical Momentum:
   P = mv + qA (A is vector potential)</p>
</li>
<li>
<p>Magnetic Mirror Force:
   F_∥ = -μ∇_∥B</p>
</li>
<li>
<p>Mirror Ratio and Loss Cone:
   R = B_max/B_min
   sin²(θ) &gt; 1/R (trapping condition)</p>
</li>
<li>
<p>Relativistic Effects:</p>
<ul>
<li>Relativistic mass: m = γm₀</li>
<li>Lorentz factor: γ = 1/√(1-v²/c²)</li>
<li>Relativistic cyclotron frequency: ω_c = qB/(γm₀)
""" </li>
</ul>
</li>
</ol>
</div>
</div><footer>
<div aria-label="Footer Navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral float-left" href="../../3%20Waves/Problem_1/" title="Problem 1"><span class="icon icon-circle-arrow-left"></span> Previous</a>
<a class="btn btn-neutral float-right" href="../../5%20Circuits/Problem_1/" title="Problem 1">Next <span class="icon icon-circle-arrow-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="Versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span><a href="../../3%20Waves/Problem_1/" style="color: #fcfcfc">« Previous</a></span>
<span><a href="../../5%20Circuits/Problem_1/" style="color: #fcfcfc">Next »</a></span>
</span>
</div>
<script src="../../../js/jquery-3.6.0.min.js"></script>
<script>var base_url = "../../..";</script>
<script src="../../../js/theme_extra.js"></script>
<script src="../../../js/theme.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script src="../../../search/main.js"></script>
<script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>
</body>
</html>
